- defaults:
    name: global
    branch_master: master
    branch_feature_prefix: feature/
    tag_beta_prefix: beta/
    tag_release_prefix: release/
    github_host: github.com
    cumulusci_user: SalesforceFoundation
    cumulusci_job: CumulusCI-master

- job-template:
    name: 'CumulusCI-{branch}'
    scm:
        - git:
            url: git@{github_host}:{cumulusci_user}/CumulusCI.git
            branches:
                - origin/{branch}
            skip-tag: true
    triggers:
        - github

- job-template:
    name: '{name}-feature'
    properties:
        inject:
            properties-content: |
                CUMULUSCI_PATH=../{cumulusci_job}/workspace
    scm:
        - git:
            url: git@{github_host}:{github_user}/{name}.git
            branches:
                - origin/${{branch}}
            skip-tag: true
    builders:
        - ant:
            targets: deployCI
            properties:
                propertyfile: /var/jenkins_credentials/salesforce/{name}.feature

- job-template:
    name: '{name}-master'
    properties:
        inject:
            properties-content: |
                CUMULUSCI_PATH=../{cumulusci_job}/workspace
    scm:
        - git:
            url: git@{github_host}:{github_user}/{name}.git
            branches:
                - origin/{branch_master}
            skip-tag: true
    triggers:
        - github
    builders:
        - ant:
            targets: deployCI
            properties:
                propertyfile: /var/jenkins_credentials/salesforce/{name}.master

- project:
    branch: master
    name: CumulusCI-{branch}
    jobs:
        - 'CumulusCI-{branch}'

- project:
    name: GrantLifecycleApp
    github_user: jlantz
    jobs:
        - '{name}-feature'
        - '{name}-master'
